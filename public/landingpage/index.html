<!DOCTYPE html>
<html>
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-29EHQVF8J1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-29EHQVF8J1');
    </script>
    <title>Fruta no pé em Sanja</title>
    <meta charset="utf-8" />
    <meta name="description" content="Busque árvores com frutos perto de você em São José dos Campos.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-omnivore/leaflet-omnivore.js"></script>
    <script src="trees.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        header a, footer * {
            font-weight: bold;
            font-family: Noteworthy,serif;
            color: green !important;
        }
        header nav div, footer, body{
            background-color: lightgreen;
            border-color: lightgreen;
        }
        .author{
            font-weight: bold;
            color: green !important;
        }
        .leftFooter{
            font-weight: bold;
            color: green !important;
            font-size: 10pt;
        }
        main {
            padding-top: 70px;
        }
        .desc {
            font-family: Arial,fantasy;
            font-style: italic;
            color: green;
        }
        .imgTable {
            width: 32px;
            height: 32px;
        }

        .tableHeader {
            background-color: green !important;
            color: white !important;
        }

        @media all and (max-width: 800px) {
            .desc {
                font-size: 12px;
            }
            main {
                padding-top: 90px;
            }
            table td {
                font-size: 8px !important;
            }
            tr .badge {
                display: block; /* or inline-block, depending on your layout needs */
                white-space: normal;
                width: max-content;
                font-size: 9px !important;
            }
        }
    </style>
</head>
<body>
<header data-bs-theme="light">
    <nav class="navbar navbar-expand-md navbar-light fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="happy-orange-fruit.png" style="width: 60px; height: 60px">
                    Fruta no pé em Sanja
            </a>
            <span class="fst-italic desc">
                Mapa das árvores frutíferas em São José dos Campos
            </span>
        </div>
    </nav>
</header>
<main>
    <div id="map" style="height: 550px;"></div>
    <div class="row">
        <div class="col">
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th scope="col" colspan="7" class="tableHeader">Frutas</th>
                    </tr>
                </thead>
                <tbody>
                <tr>
                    <td>
                        <img alt="Goiaba" src="guava.png" class="imgTable"> Goiaba
                        <span id="goiabaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Jaca" src="jack-fruit.png" class="imgTable">Jaca
                        <span id="jacaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Laranja" src="orange.png" class="imgTable">Laranja
                        <span id="laranjaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Manga" src="mango.png" class="imgTable">Manga
                        <span id="mangaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Abacate" src="avocado.png" class="imgTable">Abacate
                        <span id="abacateCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Pitanga" src="pitanga.png" class="imgTable">Pitanga
                        <span id="pitangaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Mamão" src="papaya.png" class="imgTable">Mamão
                        <span id="mamãoCount" class="badge text-bg-success">Info</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <img alt="Acerola" src="acerola.png" class="imgTable">Acerola
                        <span id="acerolaCount"  class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Limão" src="lime.png" class="imgTable">Limão
                        <span id="limãoCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Amora" src="blackberry.png" class="imgTable">Amora
                        <span id="amoraCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Jaboticaba" src="jabuticaba.png" class="imgTable">Jaboticaba
                        <span id="jaboticabaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Lichia" src="lychee.png" class="imgTable">Lichia
                        <span id="lichiaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Mixirica" src="tangerine-fruit.png" class="imgTable">Mexirica
                        <span id="mixiricaCount" class="badge text-bg-success">Info</span>
                    </td>
                    <td>
                        <img alt="Fruta-do-conde" src="custard_apple.png" class="imgTable">Fruta-do-conde
                         <span id="fruta-do-condeCount" class="badge text-bg-success">Info</span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

</main>
<footer class="d-flex flex-wrap justify-content-between align-items-center py-2 my-4 border-top">
    <div class="col-md-4 d-flex align-items-center">
        <span class="mb-3 mb-md-0 text-body-secondary ">
            <a href="http://brunoborges.info/" class="author link-light link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover">
                Criado por Bruno Borges
            </a>
        </span>
    </div>
    <div class="col-md-4 d-flex align-items-right">
        <a href="https://arvores.sjc.sp.gov.br/" class="leftFooter link-light link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover">
            Esse site utiliza o catálogo arbóreo da cidade de São José dos campos
        </a>
    </div>
</footer>
<script>

    const map = L.map('map').setView([-23.1791, -45.8872], 11);
    let additionalDesc = ''

    map.locate({setView: true, maxZoom: 16});

    function onLocationFound(e) {
        const radius = e.accuracy;

        L.marker(e.latlng).addTo(map)
            .bindPopup("Você está aqui").openPopup();

        L.circle(e.latlng, radius).addTo(map);
    }

    map.on('locationfound', onLocationFound);

    const guavaIcon = L.icon({
        iconUrl: 'guava.png',
        iconSize:     [70, 70],
    });

    const mangoIcon = L.icon({
        iconUrl: 'mango.png',
        iconSize:     [70, 70],
    });

    const orangeIcon = L.icon({
        iconUrl: 'orange.png',
        iconSize:     [80, 80],
    });

    const jackIcon = L.icon({
        iconUrl: 'jack-fruit.png',
        iconSize:     [70, 70],
    });

    const acerolaIcon = L.icon({
        iconUrl: 'acerola.png',
        iconSize:     [70, 70],
    });

    const jabuticabaIcon = L.icon({
        iconUrl: 'jabuticaba.png',
        iconSize:     [70, 70],
    });

    const limeIcon = L.icon({
        iconUrl: 'lime.png',
        iconSize:     [70, 70],
    });

    const condeIcon = L.icon({
        iconUrl: 'custard_apple.png',
        iconSize:     [70, 70],
    });

    const blackberryIcon = L.icon({
        iconUrl: 'blackberry.png',
        iconSize:     [70, 70],
    });

    const avocadoIcon = L.icon({
        iconUrl: 'avocado.png',
        iconSize:     [70, 70],
    });

    const pitangaIcon = L.icon({
        iconUrl: 'pitanga.png',
        iconSize:     [70, 70],
    });

    const lycheeIcon = L.icon({
        iconUrl: 'lychee.png',
        iconSize:     [70, 70],
    });

    const papayaIcon = L.icon({
        iconUrl: 'papaya.png',
        iconSize:     [70, 70],
    });

    const tangerineIcon = L.icon({
        iconUrl: 'tangerine-fruit.png',
        iconSize:     [70, 70],
    });

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    const countFruits = []

    trees.forEach(function (tree) {
        let fruitIcon
        let skip = false

        const nameParts = tree.name.split(",")
        const fruitName = nameParts[0].toLowerCase();

        if (countFruits[fruitName] === undefined) {
            countFruits[fruitName] = 1;
        } else {
            countFruits[fruitName] =  countFruits[fruitName] + 1;
        }

        switch (tree.name) {
            case "Goiaba, Goiabeira":
                fruitIcon = guavaIcon
                additionalDesc = 'Pode ser encontrada ao longo do ano, com uma produção mais concentrada nos meses mais quentes'
                break
            case "Jaca, Jaqueira":
                fruitIcon = jackIcon
                additionalDesc = 'Costuma frutificar na primavera e no verão.'
                break
            case "Laranja, Laranjeira":
                fruitIcon = orangeIcon
                additionalDesc = 'Podem ser encontradas durante grande parte do ano.'
                break
            case "Manga, Mangueira":
                fruitIcon = mangoIcon
                additionalDesc = 'Geralmente, a safra de manga ocorre na primavera e no verão.'
                break
            case "Acerola":
                fruitIcon = acerolaIcon
                additionalDesc = 'Pode ser encontrada durante o ano, mas a produção é geralmente mais intensa na primavera e no verão.'
                break
            case "Jaboticaba, Jabuticaba, Jaboticabeira, Jabuticabeira":
                fruitIcon = jabuticabaIcon
                additionalDesc = 'Costuma frutificar na primavera e no início do verão.'
                break
            case "Limão, Limoeiro":
                fruitIcon = limeIcon
                additionalDesc = 'Pode ser encontrado ao longo do ano, mas algumas variedades têm uma produção mais intensa no inverno.'
                break
            case "Amora, Amoreira":
                fruitIcon = blackberryIcon
                additionalDesc = 'A produção principal ocorre na primavera e no verão.'
                break
            case "Fruta-do-conde, Ata, Pinha":
                fruitIcon = condeIcon
                additionalDesc = 'Pode ser encontrada ao longo do ano, mas a produção é geralmente mais intensa no verão.'
                break
            case "Abacate, Abacateiro":
                fruitIcon = avocadoIcon
                additionalDesc = 'Dependendo da variedade, os abacates podem ser encontrados durante o ano, com uma produção mais intensa na primavera e no verão.'
                break
            case "Pitanga, Pitangueira":
                fruitIcon = pitangaIcon
                additionalDesc = 'Maior incidência de frutas maduras nos meses mais quentes do ano'
                break
            case "Lichia, Lixia":
                fruitIcon = lycheeIcon
                additionalDesc = 'A lichieira é uma planta que geralmente dá frutos uma vez por ano. Em geral, as lichias costumam frutificar durante o verão'
                break
            case "Mamão, Mamoeiro":
                fruitIcon = papayaIcon
                additionalDesc = 'Os mamoeiros geralmente produzem frutos de forma contínua, sem uma estação específica para a frutificação.'
                break
            case "Mixirica, Mexirica":
                fruitIcon = tangerineIcon
                additionalDesc = 'Em geral, as mixiricas tendem a produzir frutos no outono e inverno'
                break
            default:
                skip = true
                break;
        }

        if (!skip) {
            L.marker([tree.latitude.replace(",","."), tree.longitude.replace(",",".")],  {icon: fruitIcon}).
            bindPopup("<b>" + tree.name + "</b>: " + additionalDesc)
                .openPopup().addTo(map);
        }
    });

    Object.keys(countFruits).forEach(function (fruit) {
        let fruitElement = document.getElementById(fruit + "Count")
        if (fruitElement) {
            fruitElement.innerText = countFruits[fruit];
        }
    })
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>
